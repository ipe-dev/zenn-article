---
title: "Laravelã®ãƒªã‚¹ãƒŠã‚’éåŒæœŸã§å‹•ã‹ã™"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [laravel]
published: true
---
Eventã¨Listenerã‚’ä½œæˆã—ã¦éåŒæœŸã§å®Ÿè¡Œã•ã›ã‚‹ã¾ã§ã®æµã‚Œã‚’è¨˜è¼‰ã—ã¾ã™
# çµè«–
- jobsãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹
- Eventã¨Listenerã‚’ä½œæˆã™ã‚‹
- .envã®`QUEUE_CONNECTION`ã‚’è¨­å®šã™ã‚‹
- Listenerã‚¯ãƒ©ã‚¹ã«`ShouldQueue`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’implementsã™ã‚‹ã“ã¨ã§éåŒæœŸå‡¦ç†ãŒå¯èƒ½
# ç’°å¢ƒ
laravel 10
# å‰æº–å‚™
## jobsãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
æœ€åˆã«ã‚­ãƒ¥ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®`jobs`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”¨æ„ã—ã¾ã™
```bash
php artisan queue:table
```
```bash
php artisan migrate
```
## Eventã‚¯ãƒ©ã‚¹ä½œæˆ
æ¬¡ã«listenerãŒå®Ÿè¡Œã•ã‚Œã‚‹èµ·ç‚¹ã¨ãªã‚‹Eventã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™
```bash
php artisan make:event HogeEvent
```
## Listenerä½œæˆ
EventãŒç™ºè¡Œã•ã‚ŒãŸå¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹Listenerã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™
```bash
php artisan make:listener FugaListener --event=HogeEvent
```
## .envã‚’ç·¨é›†
```
QUEUE_CONNECTION=database
```
ã“ã“ãŒ`sync`ã«ãªã£ã¦ã„ã‚‹ã¨Eventã¨ListenerãŒåŒæœŸçš„ã«å‡¦ç†ã•ã‚Œã¾ã™
## EventProviderã«ç™»éŒ²ã™ã‚‹
```php:App/Providers/EventServiceProvider.php
protected $listen = [
    HogeEvent::class => [
        FugaListener::class,
    ],
];
```
# listenerã‚’queueã§å‡¦ç†ã™ã‚‹ã‚ˆã†ã«è¨­å®š
```php:app/Listeners/FugaListener.php
final class FugaListener implements shouldQueue
{
    // çœç•¥
}
```
ä¸Šè¨˜ã®ã‚ˆã†ã«`shouldQueue`ã‚’implementsã™ã‚‹ã“ã¨ã§listenerãŒqueueå‡¦ç†ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚